import os
import sys
import typer
from commands.ignoreFromCveinCsv import *
from api.csvReader import *
from api.snykApi import *
from api.utility import *

# Create typer app
app = typer.Typer()

@app.command(help="Ignore based off of a CSV file.")
def ignore_from_cve_in_csv(
    file:str = typer.Argument(..., help="Please specify full path to CSV file")
    ):

    if os.path.isfile(file) and file.endswith('.csv'):
        print("Found csv file")
    else:
        print("File supplied is invalid, please enter a valid full path to csv file")
        sys.exit(1)
    
    ignoreFromCveInCsv(file)

@app.command(help="Dry run for ignoring based off of a CSV file. Specify full path to CSV")
def ignore_from_cve_in_csv_dry_run(file:str = typer.Argument(..., help="Please specify full path to CSV file")):
    if os.path.isfile(file) and file.endswith('.csv'):
        print("Found csv file") 
    else:
        print("File supplied is invalid, please enter a valid full path to csv file")
        sys.exit(1)

    ignoreFromCveInCsvDryRun(file)
if __name__ == "__main__":
    app()