import re
import csv

# Find CVE data in CSV
def extract_cve_data_from_csv(csvFilePath):
    cveData = []
    cveTester = re.compile('CVE-\d{4}-\d{4,7}')
    # Open CSV file and create object then close
    try:
        csvFile = open(csvFilePath)
        csvObject = csv.reader(csvFile)

        for csvRow in csvObject:
            if cveTester.match(csvRow[2]):
                cveData.append(csvRow[2])

    except:
        print("Failed to open and read CSV file:")
    finally:
        csvFile.close()
        return cveData